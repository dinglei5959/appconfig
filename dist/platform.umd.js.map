{"version":3,"file":"platform.umd.js","sources":["../src/lib/eventold.ts","../src/lib/platform-type.ts","../src/lib/utils.ts","../src/platform.ts"],"sourcesContent":["\r\n/**\r\n * @description \r\n * 改版后的订阅模式是有命名空间的 默认是放在 DEFUALTNAMESPACE下\r\n * 所以_listen已经变成三个 参数  key  cb  加 空间名 \r\n * \r\n */\r\nconst DEFUALTNAMESPACE = 'default';\r\nconst namespaceCache:object = {};\r\n\r\nconst _slice = Array.prototype.slice;\r\nconst _shift = Array.prototype.shift;\r\nconst _unshift = Array.prototype.unshift;\r\n\r\nfunction each(stack:Array<any>, fn:Function) {\r\n  var ret;\r\n  for (var i = 0, l = stack.length; i < l; i++) {\r\n    var stackFun = stack[i];\r\n    ret = fn.call(stackFun, i, stackFun);\r\n  }\r\n  return ret;\r\n};\r\n\r\n/**\r\n * 监听 存放订阅者的信息\r\n * @param key -- \r\n * @param cb -- 处理函数\r\n * @param cache -- 命名空间 的访问key\r\n */\r\nexport function _listen(key:string, cb:Function, cache:object = {}) {\r\n  if ( !(key in cache)  ) {\r\n    cache[key] = [];\r\n  }\r\n  cache[key].push(cb);\r\n}\r\n\r\n\r\n/**\r\n * 触发事件\r\n */\r\nexport function _trigger () {\r\n  const cache = Array.prototype.shift.call(arguments);\r\n  const key = Array.prototype.unshift.call(arguments);\r\n  const  args = arguments;\r\n  const  scope:any = this;\r\n  let stack:Array<Function> = cache[key]; // 缓存订阅的方法库\r\n  if (!stack || !stack.length) {\r\n    return;\r\n  }\r\n  return each(stack, function () {\r\n    //这里涉及到一个高级用法   希望  stack 里面的函数每个 都能使用\r\n    this.apply(scope, args);  // this 指向的是 stack里面的函数 所以能直接执行\r\n  });\r\n};\r\n\r\n\r\n\r\nexport function _remove(key, cache, fn?) {\r\n  if (cache[key]) {\r\n    if (fn) {\r\n      for (var i = cache[key].length; i >= 0; i--) {\r\n        if (cache[key][i] === fn) {\r\n          cache[key].splice(i, 1);\r\n        }\r\n      }\r\n    } else {\r\n      cache[key] = [];\r\n    }\r\n  }\r\n};\r\n\r\nexport function _create (namespace?:string) {\r\n    namespace = namespace || DEFUALTNAMESPACE;\r\n    let cache = {};\r\n    let offlineStack:Array<any> | null = []; // 离线事件\r\n    let ret = {\r\n      listen: function(key, fn, last) {\r\n        _listen(key, fn, cache);\r\n\r\n        if (offlineStack === null) {\r\n          return;\r\n        }\r\n        \r\n        //最后模式\r\n        if (last === 'last') {\r\n          offlineStack.length && offlineStack.pop()();\r\n        } else {\r\n          each(offlineStack, function() {\r\n            this();\r\n          });\r\n        }\r\n\r\n        offlineStack = null;\r\n      },\r\n      one: function(key, fn, last) {\r\n        _remove(key, cache);\r\n        this.listen(key, fn, last);\r\n      },\r\n      remove: function(key, fn) {\r\n        _remove(key, cache, fn);\r\n      },\r\n      trigger: function() {\r\n        var fn,\r\n          args,\r\n          _self = this;\r\n        _unshift.call(arguments, cache);\r\n        args = arguments;\r\n        fn = function() {\r\n          return _trigger.apply(_self, args);\r\n        };\r\n        if (offlineStack) {\r\n          return offlineStack.push(fn);\r\n        }\r\n        return fn();\r\n      }\r\n    };\r\n\r\n  return namespace\r\n    ? namespaceCache[namespace]\r\n      ? namespaceCache[namespace]\r\n      : (namespaceCache[namespace] = ret)\r\n    : ret;\r\n    \r\n};\r\n\r\nexport default {\r\n  create: _create,\r\n  one: function(key, fn, last) {\r\n    var event = this.create();\r\n    event.one(key, fn, last);\r\n  },\r\n  remove: function(key, fn) {\r\n    var event = this.create();\r\n    event.remove(key, fn);\r\n  },\r\n  listen: function(key, fn, last?) {\r\n    var event = this.create();\r\n    event.listen(key, fn, last);\r\n  },\r\n  trigger: function(name?:string) {\r\n    var event = this.create();\r\n    event.trigger.apply(this, arguments);\r\n  }\r\n}\r\n","\r\n/**\r\n * 手机类型标识\r\n */\r\nexport const mobile:string[] = [\r\n  'Android',\r\n  'iPhone',\r\n  'SymbianOS',\r\n  'Windows Phone'\r\n]\r\n\r\n/**\r\n * ipad标识\r\n */\r\nexport const pad:string = 'iPad';\r\n\r\n/**\r\n * 终端枚举\r\n */\r\nexport const enum Terminal {\r\n  MOBILE = \"mobile\",\r\n  PC = 'pc',\r\n  PAD = 'pad'\r\n}","import { pad } from './platform-type';\r\n\r\n\r\n/**\r\n * 是否为平板\r\n * @param plt \r\n */\r\nexport function isTablet(): boolean {\r\n  let smallest = Math.min(this.getWidth(), this.getHeight());\r\n  let largest = Math.max(this.getWidth(), this.getHeight());\r\n  const matchSize = (smallest > 460 && smallest < 1100) &&\r\n    (largest > 780 && largest < 1400);\r\n\r\n  const matchUa = this.userAgent.indexOf(pad) > -1 ;\r\n  return matchSize && matchUa;\r\n}\r\n\r\n /**\r\n * 加载script\r\n * @param {String} url -- 链接\r\n */\r\nexport function loadScript(url:string) {\r\n  return new Promise((resolve, reject) => {\r\n    let _head = document.getElementsByTagName('head')[0];\r\n    let _script = document.createElement('script');\r\n    _script.setAttribute('type', 'text/javascript');\r\n    _script.setAttribute('src', url);\r\n    _head.appendChild(_script);\r\n    _script.onload = function() {\r\n      resolve();\r\n    };\r\n    _script.onerror = function(err) {\r\n      reject(err);\r\n    };\r\n  });\r\n}\r\n\r\n  /**\r\n   * document的ready事件监听\r\n   * @param {Function} [callback] - 回调函数\r\n   * @return {Promise} - 返回promise，completed后自动解绑\r\n   * */\r\nexport function  docReady (callback:Function) {\r\n  let promise:any = null; // Promise;\r\n\r\n  if (!callback) {\r\n    // a callback wasn't provided, so let's return a promise instead\r\n    promise = new Promise(function(resolve) {\r\n      callback = resolve;\r\n    });\r\n  }\r\n\r\n  /* istanbul ignore else */\r\n  if (\r\n    document.readyState === 'complete' ||\r\n    document.readyState === 'interactive'\r\n  ) {\r\n    callback();\r\n  } else {\r\n    document.addEventListener('DOMContentLoaded', completed, false);\r\n    window.addEventListener('load', completed, false);\r\n  }\r\n\r\n  /* istanbul ignore next */\r\n  function completed() {\r\n    document.removeEventListener('DOMContentLoaded', completed, false);\r\n    window.removeEventListener('load', completed, false);\r\n    callback();\r\n  }\r\n\r\n  return promise;\r\n}\r\n","\r\nimport Config from './lib/config';\r\nimport event from './lib/eventold';\r\nimport { mobile as PhoneTypeList , Terminal } from './lib/platform-type';\r\nimport { isTablet , loadScript , docReady } from './lib/utils';\r\n\r\nconst LISTEN = 'WAITFORBRIDGE'; // 等待 jsbridge加载的信息。。\r\nconst MESSAGE = 'platform got ready!';\r\n\r\nexport default  class Platform {\r\n  private matchlist:Array<string> = []; // 计算的平台列表\r\n  private debug:boolean; // 是否设置为 调试模式  打印具体信息\r\n  private isPortrait:boolean | null = null; // 是否为竖屏的判断\r\n  private win:Window|null; // 当前 frame的window对象\r\n  private width:number|null = null; // 宽度\r\n  private height:null|number = null; // 高度\r\n  private configs:Array<Config>; // 配置项\r\n  private userAgent:string; //\r\n\r\n  constructor(props:any){\r\n    const { configs , debug  } = props;\r\n\r\n    this.configs = configs;\r\n    this.debug = debug;\r\n    this.win = document.defaultView;\r\n    this.userAgent = this.win ? this.win.navigator.userAgent : '';\r\n    this._calcDim();\r\n\r\n  }\r\n\r\n  /**\r\n   * 开始识别\r\n   */\r\n  startRecognition() {\r\n    \r\n    // 识别终端  手机识别到具体类型\r\n    this.recogTerminal(); \r\n\r\n    if ( this.configs ) { // 存在配置项则进行具体平台识别\r\n      return this.recogPlatform();\r\n    } else { // 直接进行ready操作\r\n      return this.ready();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 识别终端  如果是 mobile 则添加具体 类型\r\n   */\r\n  recogTerminal(){\r\n\r\n    for(let i = 0 ; i< PhoneTypeList.length ; i++ ){\r\n      if(this.userAgent.indexOf(PhoneTypeList[i])>-1){\r\n        this.matchlist.push(Terminal.MOBILE);\r\n        this.matchlist.push(PhoneTypeList[i]);\r\n      }\r\n    }\r\n\r\n    if(isTablet.apply(this)){\r\n      this.matchlist = [];\r\n      this.matchlist.push(Terminal.PAD);\r\n    }\r\n\r\n    if(this.matchlist.length === 0){\r\n      this.matchlist.push(Terminal.PC);\r\n    }\r\n    \r\n  }\r\n\r\n   /**\r\n   * 识别具体 app 平台\r\n   */\r\n  recogPlatform() {\r\n    Object.keys(this.configs).forEach((key:string) => {\r\n      // 配置处理\r\n      const config:Config = this.configs[<any>key];\r\n      let reg:string|RegExp = config.pltReg || key;\r\n      if (!(reg instanceof RegExp)) {\r\n        reg = new RegExp(reg);\r\n      }\r\n      reg.test(this.userAgent) && this.matchlist.push(key);\r\n    });\r\n    return this.ready();\r\n  }\r\n\r\n\r\n  /**\r\n   * 加载js bridge两种方式\r\n   */\r\n  ready() {\r\n    const key:string = this.matchlist[this.matchlist.length - 1];\r\n    const config = this.configs[<any>key] || null;\r\n    return new Promise((resolve, reject) => {\r\n\r\n      if (!config) { // 不存在配置项直接报错\r\n        return this.debug && reject(new Error('非第三方app'));\r\n      }\r\n      \r\n      if (config.jsSDKUrl) { //  使用配置 url\r\n        // 第二种方式\r\n        loadScript(config.jsSDKUrl).then(() => {\r\n          docReady(() => {\r\n            if (config.loadWay) {\r\n              event.listen(LISTEN, () => {\r\n                resolve(key);\r\n              });\r\n              config.loadWay(this);\r\n            } else {\r\n              resolve(key);\r\n            }\r\n          });\r\n        });\r\n        return false;\r\n      }\r\n      this.debug &&  reject(new Error('缺少加载方式。。'));\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 触发ready\r\n   * @param {*} message\r\n   */\r\n  triggerReady(message:string) {\r\n    if(this.debug){\r\n      console.log(MESSAGE);\r\n      console.log(message);\r\n    }\r\n    event.trigger(LISTEN);\r\n  }\r\n\r\n  triggerFail(error:string) {\r\n    this.debug && console.error(error);\r\n  }\r\n\r\n\r\n  /**\r\n   * 是否为某个平台\r\n   */\r\n  isMatch(regList:string|string[]):boolean {\r\n    let res = false;\r\n    this.matchlist.forEach((ele:string, index) => {\r\n\r\n      if(typeof regList === 'string'){ // string 直接比对\r\n        ele.toLocaleLowerCase() === regList.toLocaleLowerCase() && (res = true);\r\n      } else { // 数组 则遍历比对\r\n        regList.forEach((regx)=>{\r\n          ele.toLocaleLowerCase() === regx.toLocaleLowerCase() && (res = true);\r\n        });\r\n      }\r\n     \r\n    });\r\n    return res;\r\n  }\r\n\r\n  /**\r\n   * 监听jsbridge的状态\r\n   * @param {String} jsBridgeName -- 名称\r\n   * @param {String} jsBridgeListerName -- 事件\r\n   */\r\n  listenJsBridgeLoad(jsBridgeName, jsBridgeListerName,global:any) {\r\n    const PLATFORM_INIT_TIMEOUT = 10000;\r\n    if (global[jsBridgeName]) {\r\n      this.triggerReady(jsBridgeName + ' Init Success!');\r\n      'timer' in global && global.clearTimeout(global.timer);\r\n    } else {\r\n      document.addEventListener(\r\n        jsBridgeListerName,\r\n        () => {\r\n          this.triggerReady(jsBridgeName + ' Init Success!');\r\n          global.timer && global.clearTimeout(global.timer);\r\n        },\r\n        false\r\n      );\r\n    }\r\n    global.timer = global.setTimeout(() => {\r\n      this.triggerFail(jsBridgeListerName + ' Init Timeout!');\r\n    }, PLATFORM_INIT_TIMEOUT);\r\n  } \r\n\r\n\r\n  /**\r\n   * 计算\r\n   */\r\n  private _calcDim():void {\r\n    if (  \r\n      this.isPortrait === null ||\r\n      (this.isPortrait === false && this.win && this.win['innerWidth'] < this.win['innerHeight'])\r\n    ) { // 防止计算过的重复计算\r\n      const win = this.win;\r\n      if(win){\r\n        this.width = win.screen.width;\r\n        this.height = win.screen.height;\r\n        if (this.width > 0 && this.height > 0) {\r\n          /* istanbul ignore next  */\r\n          if (this.width < this.height) {\r\n            this.isPortrait = true;\r\n          } else {\r\n            // the device is in landscape\r\n            this.isPortrait = false;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 获取宽度\r\n   */\r\n  getWidth(){\r\n    return this.width;\r\n  }\r\n\r\n  /**\r\n   * 获取高度\r\n   */\r\n  getHeight(){\r\n    return this.height;\r\n  }\r\n\r\n}"],"names":["PhoneTypeList"],"mappings":"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"}